<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auctioneer Dashboard - Football Auction</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Auctioneer Dashboard</h1>
        <nav>
            <a href="index.html">Home</a>
            <span id="user-info-auctioneer">
                Logged in as: <span id="auctioneerNameDisplay">Guest Auctioneer</span> <button id="changeAuctioneerBtn" class="nav-button">Change User</button>
            </span>
        </nav>
    </header>

    <main class="auctioneer-main">
        <section id="auctioneer-setup-section" class="card">
            <h2>Start or Join Your Auction</h2>
            <form id="auctioneerSetupForm">
                <label for="auctioneerDisplayName">Your Display Name:</label>
                <input type="text" id="auctioneerDisplayName" placeholder="e.g., Master Auctioneer" required><br>

                <div id="newRoomSetup">
                    <button type="button" id="createNewRoomBtn" class="button-primary">Create New Room</button>
                    <p id="newRoomMessage" class="message"></p>
                </div>

                <div id="joinExistingRoom" style="display: none;">
                    <label for="existingRoomCode">Existing Room Code:</label>
                    <input type="text" id="existingRoomCode" placeholder="e.g., ABC123" maxlength="6" pattern="[A-Z0-9]{6}"><br>

                    <label for="manageTokenInput">Your Manage Token:</label>
                    <input type="text" id="manageTokenInput" placeholder="Paste your token here" required><br>

                    <button type="submit" id="joinRoomAsAuctioneerBtn" class="button-primary">Join Existing Room</button>
                    <p id="joinRoomMessage" class="message"></p>
                </div>
            </form>
            <p><a href="#" id="toggleRoomModeLink">Already have a room? Join existing.</a></p>
        </section>

        <section id="auctioneer-dashboard" style="display: none;">
            <section class="room-control-section">
                <div class="room-code-display card">
                    <h3>Your Auction Room</h3>
                    <p>Room Code: <span id="roomCodeDisplay">Loading...</span> <button id="copyRoomCodeBtn" class="button-small">Copy</button></p>
                    <p>Manage Token: <span id="manageTokenDisplay" style="word-break: break-all;">Loading...</span> <button id="copyManageTokenBtn" class="button-small">Copy</button></p>
                    <p class="warning-text">**IMPORTANT**: Save this token! You'll need it to manage this room again.</p>
                </div>
                <div class="room-status-control card">
                    <h3>Room Status</h3>
                    <p>Status: <span id="roomStatusDisplay" class="status-badge status-lobby">Lobby</span></p>
                    <button id="startAuctionBtn" class="button-primary">Start Auction</button>
                    <button id="endAuctionBtn" class="button-secondary" style="display: none;">End Room</button>
                </div>
            </section>

            <section class="auction-management-section">
                <div class="create-player-form card">
                    <h2>List a New Player</h2>
                    <form id="playerAuctionForm">
                        <label for="playerName">Player Name:</label>
                        <input type="text" id="playerName" name="playerName" required><br>

                        <label for="playerClubNationality">Club/Nationality:</label>
                        <input type="text" id="playerClubNationality" name="playerClubNationality"><br>

                        <label for="startPrice">Starting Price (₹):</label>
                        <input type="number" id="startPrice" name="startPrice" step="100" min="100" required><br>

                        <label for="imageUrl">Image URL (Optional):</label>
                        <input type="url" id="imageUrl" name="imageUrl"><br>

                        <label for="bidIncrement">Bid Increment (₹):</label>
                        <input type="number" id="bidIncrement" name="bidIncrement" step="10" min="10" value="100" required><br>

                        <button type="submit" class="button-primary">Add Player to Auction</button>
                    </form>
                    <p id="formMessage" class="message"></p>
                </div>

                <div class="current-auction-card card">
                    <h2>Current Player Auction</h2>
                    <div id="currentAuctionDetails">
                        <p class="placeholder-text">No player currently active. Add a player above!</p>
                    </div>
                    <div id="auctionControlButtons" style="display: none;">
                        <button id="activateAuctionBtn" class="button-primary">Start Bidding</button>
                        <button id="finalCallBtn" class="button-secondary">Final Call</button>
                        <button id="nextPlayerBtn" class="button-tertiary">Next Player</button>
                        <p id="auctionStatusMessage" class="message"></p>
                    </div>
                </div>
            </section>

            <section class="realtime-info-section">
                <div class="participants-list card">
                    <h2>Live Participants</h2>
                    <ul id="participantsList">
                        </ul>
                </div>

                <div class="auction-queue-list card">
                    <h2>Players in Queue</h2>
                    <ul id="playersInQueue">
                        </ul>
                </div>
            </section>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Football Auction. All rights reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabaseClient.js"></script>
    <script src="auctioneer.js"></script>
</body>
</html>
