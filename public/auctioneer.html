<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Auctioneer Panel</title>
  <link rel="stylesheet" href="style.css" />
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <div class="container">
    <h2>Auctioneer Panel</h2>
    <input id="roomName" placeholder="Enter Room Name" />
    <button onclick="createRoom()">Create Room</button>
    <p id="inviteLink"></p>

    <h3>Player Auction</h3>
    <input id="playerName" placeholder="Player Name" />
    <input id="playerClub" placeholder="Club/Nationality" />
    <input id="playerPosition" placeholder="Position" />
    <input id="playerStyle" placeholder="Playing Style" />
    <input id="playerValue" placeholder="Base Value" type="number" />
    <button onclick="startAuction()">Start Bidding</button>
    <button onclick="finalCall()">Final Call</button>

    <div id="status"></div>
  </div>

  <script>
    const socket = io();
    let currentRoom = "";

    function createRoom() {
      const roomName = document.getElementById("roomName").value;
      if (roomName) {
        socket.emit("createRoom", roomName);
      }
    }

    socket.on("roomCreated", (roomName) => {
      currentRoom = roomName;
      const link = `${window.location.origin}/bidder.html?room=${roomName}`;
      document.getElementById("inviteLink").innerHTML = 
        `‚úÖ Room Created! Share this link: <br><a href="${link}" target="_blank">${link}</a>`;
    });

    function startAuction() {
      const player = {
        name: document.getElementById("playerName").value,
        club: document.getElementById("playerClub").value,
        position: document.getElementById("playerPosition").value,
        style: document.getElementById("playerStyle").value,
        value: parseInt(document.getElementById("playerValue").value) || 0
      };
      socket.emit("startAuction", { roomName: currentRoom, player });
    }

    function finalCall() {
      socket.emit("finalCall", currentRoom);
    }

    socket.on("auctionFinalized", (data) => {
      document.getElementById("status").innerHTML = 
        `üèÜ ${data.winner} won ${data.player.name} for $${data.bid}`;
    });
  </script>
</body>
</html>