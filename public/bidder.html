<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bidder</title>
  <link rel="stylesheet" href="style.css">
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <div class="glass-container">
    <h2>Bidder</h2>

    <div id="join">
      <input type="text" id="participantName" placeholder="Your Name">
      <input type="text" id="roomCode" placeholder="Room Code">
      <button id="joinRoomBtn">Join Room</button>
    </div>

    <div id="auction" style="display:none;">
      <h3 id="playerDetails"></h3>
      <div id="currentBid"></div>

      <input type="number" id="bidValue" placeholder="Enter Bid">
      <button id="placeBid">Place Bid</button>

      <div id="status"></div>
    </div>
  </div>

  <script>
    const socket = io();
    let roomCode, participantName;

    document.getElementById("joinRoomBtn").onclick = () => {
      participantName = document.getElementById("participantName").value;
      roomCode = document.getElementById("roomCode").value;

      socket.emit("joinRoom", { roomName: roomCode, participantName });
      document.getElementById("join").style.display = "none";
      document.getElementById("auction").style.display = "block";
    };

    socket.on("newPlayer", (player) => {
      document.getElementById("playerDetails").innerText =
        `${player.name} (${player.club}) - ${player.position}, ${player.style}, Base: ${player.value}`;
      document.getElementById("currentBid").innerText = `Current Bid: ${player.value}`;
    });

    document.getElementById("placeBid").onclick = () => {
      const bidValue = parseInt(document.getElementById("bidValue").value);
      socket.emit("placeBid", { roomName: roomCode, bidder: participantName, bidValue });
    };

    socket.on("bidUpdate", ({ bidder, bidValue }) => {
      document.getElementById("currentBid").innerText = `Current Bid: ${bidValue} by ${bidder}`;
    });

    socket.on("finalResult", ({ winner, amount }) => {
      document.getElementById("status").innerHTML =
        `<b>Sold to ${winner} for ${amount}!</b>`;
    });
  </script>
</body>
</html>