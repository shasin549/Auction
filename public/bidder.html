<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bidder Panel</title>
  <link rel="stylesheet" href="style.css" />
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <div class="container">
    <h2>Bidder Panel</h2>
    <input id="participantName" placeholder="Your Name" />
    <input id="roomCode" placeholder="Enter Room Code" />
    <button onclick="joinRoom()">Join Room</button>

    <div id="auctionArea" style="display:none;">
      <h3 id="playerDetails"></h3>
      <input id="bidValue" placeholder="Your Bid" type="number" />
      <button onclick="placeBid()">Place Bid</button>
      <div id="highestBid"></div>
    </div>
  </div>

  <script>
    const socket = io();
    let currentRoom = "";
    let myName = "";

    function joinRoom() {
      myName = document.getElementById("participantName").value;
      currentRoom = document.getElementById("roomCode").value;
      if (myName && currentRoom) {
        socket.emit("joinRoom", { roomName: currentRoom, participantName: myName });
      }
    }

    socket.on("roomJoined", () => {
      document.getElementById("auctionArea").style.display = "block";
    });

    socket.on("auctionStarted", (player) => {
      document.getElementById("playerDetails").innerText =
        `${player.name} (${player.club}) - ${player.position} | Style: ${player.style} | Base: $${player.value}`;
      document.getElementById("highestBid").innerText =
        `Highest Bid: $${player.value}`;
    });

    function placeBid() {
      const bid = parseInt(document.getElementById("bidValue").value);
      if (bid && currentRoom) {
        socket.emit("placeBid", { roomName: currentRoom, bid, bidder: myName });
      }
    }

    socket.on("newBid", (data) => {
      document.getElementById("highestBid").innerText =
        `Highest Bid: $${data.bid} by ${data.bidder}`;
    });

    socket.on("auctionFinalized", (data) => {
      document.getElementById("highestBid").innerText =
        `🏆 ${data.winner} won ${data.player.name} for $${data.bid}`;
    });
  </script>
</body>
</html>