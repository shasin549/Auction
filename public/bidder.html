<!DOCTYPE html>
<html>
<head>
  <title>Bidder</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="glass" id="joinBox">
    <h2>Join Auction</h2>
    <input id="bidderName" placeholder="Your Name">
    <input id="roomCode" placeholder="Room Code">
    <button onclick="joinRoom()">Join Room</button>
    <p id="error"></p>
  </div>

  <div class="glass" id="bidBox" style="display:none;">
    <h2>Bidder Panel</h2>
    <div id="playerPreview"></div>
    <h3 id="currentBid">No bids yet</h3>
    <input id="bidValue" type="number" placeholder="Enter Bid">
    <button onclick="placeBid()">Place Bid</button>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    let currentRoom = null;
    let bidderName = null;

    function joinRoom() {
      bidderName = document.getElementById("bidderName").value;
      const roomCode = document.getElementById("roomCode").value;
      socket.emit("joinRoom", { roomName: roomCode, bidderName });
    }

    socket.on("roomJoined", ({ roomName }) => {
      currentRoom = roomName;
      document.getElementById("joinBox").style.display = "none";
      document.getElementById("bidBox").style.display = "block";
    });

    socket.on("errorMsg", (msg) => {
      document.getElementById("error").innerText = msg;
    });

    socket.on("newPlayer", (player) => {
      document.getElementById("playerPreview").innerHTML = `
        <h3>${player.name}</h3>
        <p>${player.club} - ${player.position} - ${player.style}</p>
        <p>Value: ${player.value}</p>
      `;
    });

    socket.on("newBid", ({ bidder, bid }) => {
      document.getElementById("currentBid").innerText = `Highest Bid: ${bid} by ${bidder}`;
    });

    function placeBid() {
      const bid = document.getElementById("bidValue").value;
      socket.emit("placeBid", { roomName: currentRoom, bidder: bidderName, bid });
    }

    socket.on("finalCall", () => {
      alert("Final Call! Auction closed for this player.");
    });
  </script>
</body>
</html>